
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Manage Data | Coordinate</title>

    <!-- Bootstrap core CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">



    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    </style>
    <!-- Custom styles for this template -->
    <link href="css/dashboard.css" rel="stylesheet">
  </head>
  <body onload="manageData()">
    <nav class="navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow">
      <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="dashboard">Coordinate</a>
      <a class="nav-link" href="logout" style="color: white">Logout</a> 
    </nav>

<div class="container-fluid">
  <div class="row">
    <nav class="col-md-2 d-none d-md-block bg-light sidebar">
      <div class="sidebar-sticky">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link" href="dashboard">
              Dashboard 
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="create">
              Create a New Dataset
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="manageData">
              Manage Existing Datasets
            </a>
          </li>
        </ul>

        <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
          <span>Other</span>
          <a class="d-flex align-items-center text-muted" href="#">
          </a>
        </h6>
                <ul class="nav flex-column mb-2">
          <li class="nav-item">
            <a class="nav-link" href="support">
              <span data-feather="file-text"></span>
              Contact Us
            </a>
          </li>
        </ul>
	<ul class="nav flex-column mb-2">
          <li class="nav-item">
            <a class="nav-link" href="deleteAccount">
              <span data-feather="file-text"></span>
              Delete Account
            </a>
          </li>
        </ul>
        </ul>
	<ul class="nav flex-column mb-2">
          <li class="nav-item">
            <a class="nav-link" href="privacyPolicy">
              <span data-feather="file-text"></span>
              Privacy Policy
            </a>
          </li>
        </ul>
      </div>
    </nav>

    <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4">
      <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3">
        <h1 class="h2">Manage Data</h1>
      </div>
      <table id="dataList"></table>

    </main>
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>


<script src="asyncReq.js"></script>

<script>


  function manageData() {
    loadFile("./showDatasetTable", function(result){
      // show a table of the user's datasets
      var data = JSON.parse(result);
      var table = document.getElementById('dataList');

      for (var i = 0; i < data.length; i++) {
        var name = data[i].datasetName;
        var date = data[i].date;

        //create a row for each dataset
        var row = document.createElement("TR");

        // insert the dataset name into a cell
        var nameCell = document.createElement("TD");
        var nameText = document.createTextNode(name);
        nameCell.appendChild(nameText);
        row.appendChild(nameCell);

        // insert a link to into a cell to delete the corresponding dataset
        var delCell = document.createElement("TD");
        var link = document.createElement("A");
        var linkText = document.createTextNode("delete");
        link.href = "javascript:" + "deleteData('" + i + "','" + name + "','" + date + "')";
        console.log(date);

        link.appendChild(linkText);
        delCell.appendChild(link);
        row.appendChild(delCell);

        // add the finished row
        document.getElementById("dataList").appendChild(row);
      }
    });
  }

  function deleteData(rowNum, datasetName, date) {
    //console.log("deleting " + datasetName);
    if (confirm('Are you sure you want to delete "' + datasetName + '"?') == true) {
      loadFile("./deleteDataset?datasetName=" + datasetName + "&date=" + date + "&rowIndex=" + rowNum,  function(row){
        document.getElementById("dataList").deleteRow(rowNum);
      });
    } else {
      console.log("Canceled");
        return
    }
  }
</script>
</html>
